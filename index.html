<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Slowed + Reverb Studio (Vanilla JS)</title>

  <!-- CSS -->
  <link rel="stylesheet" href="./style.css?v=9" />

  <!-- Libraries (same order, deferred) -->
  <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/lamejs@1.2.0/lame.min.js" defer></script>
  <script src="./app.js?v=9" defer></script>
</head>
<body>

  <!-- Sticky, full-width progress (shown only while exporting) -->
  <section id="progressWrap" class="progress-fixed hidden" aria-live="polite">
    <div class="progress-inner">
      <div class="progress">
        <div id="progressBar" class="bar" style="width:0%"></div>
      </div>
      <p id="progressText" class="muted">Preparingâ€¦</p>
    </div>
  </section>

  <!-- Sticky top bar -->
  <header class="topbar top-fixed">
    <div class="brand">
      <div class="logo">ðŸŽ§</div>
      <div>
        <h1>Virality</h1>
        <!-- <p>Drag & drop Â· live tweak Â· individual / batch downloads</p> -->
      </div>
    </div>

    <div class="actions-row">
      <label class="format">
        <span>Format:</span>
        <select id="formatSelect">
          <option value="mp3">MP3</option>
          <option value="wav" selected>WAV (fast)</option>
        </select>
      </label>

      <label class="format" title="Lower = faster/smaller">
        <span>MP3 bitrate:</span>
        <select id="bitrateSelect">
          <option value="128">128 kbps (fast)</option>
          <option value="192" selected>192 kbps</option>
          <option value="256">256 kbps</option>
          <option value="320">320 kbps (largest)</option>
        </select>
      </label>

      <button id="downloadAll" class="btn" disabled>Download All</button>
    </div>
  </header>

  <main class="container">
    <!-- Global Player (waveform + progress) -->
    <section id="playerPanel" class="panel player">
      <h2 id="nowPlayingTitle" class="now-playing">Now Playing</h2>

      <canvas id="waveCanvas" width="1200" height="180" class="wave"></canvas>

      <div class="scrub">
        <span id="playTime">0:00</span>
        <div class="progress thin">
          <div id="playBar" class="bar" style="width:0%"></div>
        </div>
        <span id="playTotal">0:00</span>
      </div>

      <!-- Global Play/Pause row (new: keeps spacing simple & reliable) -->
      <div id="playerControlsRow" class="player-controls-row">
        <button id="globalPlayPause" class="btn">Play</button>
      </div>
    </section>

    <!-- Controls (2/3) -->
    <section class="panel controls">
      <h2>Global Controls</h2>

      <label class="slider">
        <span>Speed (playbackRate): <b id="rateVal">0.82x</b></span>
        <input id="rate" type="range" min="0.5" max="1.5" step="0.01" value="0.82" />
        <small>Slowed â‰ˆ 0.75â€“0.90 Â· Default 1.00 Â· Nightcore &gt; 1.00</small>
      </label>

      <label class="slider">
        <span>Reverb Mix: <b id="mixVal">45%</b></span>
        <input id="mix" type="range" min="0" max="1" step="0.01" value="0.45" />
      </label>

      <label class="slider">
        <span>Reverb Decay: <b id="decayVal">4.2s</b></span>
        <input id="decay" type="range" min="0.5" max="6" step="0.1" value="4.2" />
      </label>
    </section>

    <!-- Presets (1/3) -->
    <section class="panel presets">
      <h2>Presets</h2>
      <div class="preset-grid">
        <button id="presetDefault" class="btn">Default</button>
        <button id="presetSlowed" class="btn">Slowed + Reverb</button>
        <button id="presetNightcore" class="btn">Nightcore</button>
        <button id="presetFaded" class="btn">FADED</button>
      </div>
    </section>

    <!-- Files list -->
    <section class="panel files-panel">
      <div class="files-header">
        <h2>Files (<span id="fileCount">0</span>)</h2>
        <button id="clearAll" class="link" disabled>Clear all</button>
      </div>
      <div id="fileList" class="file-list"></div>
    </section>
  </main>

  <!-- Sticky Drop Footer (new location for the dropzone) -->
  <div class="drop-footer">
    <div class="drop-footer-inner">
      <div id="dropzone" class="dropzone dropzone-footer" tabindex="0" aria-label="Add audio files">
        ðŸŽµ Drag and drop audio file(s) here ðŸŽµ
      </div>
    </div>
  </div>

  <!-- Hidden file input for Browse / click from footer pill -->
  <input id="fileInput" type="file" accept="audio/*" multiple hidden />

</body>
</html>
